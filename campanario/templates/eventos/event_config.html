
{% load static %}

{% block head %}
<head>
    <title>Registros</title>
    
    <link rel="stylesheet" href="{% static 'utilidad/main.css' %}">
    <link rel="stylesheet" href="{% static 'eventos/css/event_config.css' %}">

</head>
{% endblock %}


{% include 'extends/extends_navbar.html' %}

{% block body %}
<body background="{% static 'eventos/img/bg_events.gif' %}" >
<br><br>
    <div class="main-block midtransparent">
        <h3>Programar encendido de agujas</h3>    
        <form action="{% url 'setlightstate' %}" method="post">
            {% csrf_token %}
            
            <label for="startid">Inicio: </label>
            <input type="time" min="00:00:00"  name ="start" id="startid" required>
            <label for="finishid">Fin: </label>
            
            <input type="time" name ="finish" id="finishid" required>
            <br><br>
            <input type="submit" value="Guardar">
            <script>
                var start_time = document.getElementById("startid").max;
                document.getElementById("finishid").max = start_time;

            </script>
        </form>
        <div class="normalbg">
            <h5 class="no-margin">Tiempo establecido actual</h5>
            {% for time in sched_lights %}
                <div class="flex flexcenter">
                    <div class="light-item"><p>Inicio: {{time.start_time}}</p></div>
                    <div class="light-item"><p>Fin: {{time.finish_time}}</p></div>
                </div>
            <br>
            {% empty %}
                <p>No hay nada aquí</p>
            {% endfor %}
        </div>


        <h3 >Cambiar hora del campanario</h3>
        <p>Ingresa la hora que aparece en el campanario</p>
        <p>Nota: No importa si lo ingresas con formato de 24 o 12 horas</p>
        <form action="{% url 'change_hour'%}" method="post">
            {% csrf_token %}
            🕐
            <input type="time" name="relojhora" required>
            
            {% if timeDisable is True %}
                <button type="submit" disabled>Cambiar la hora</button>
                <p>El cambio de hora se encuentra en proceso...</p>
            {% elif timeDisable is False %}
                <button id="submitbutton" onclick="this.disabled=true,this.form.submit();" type="submit" >
                Cambiar la hora
                </button>
            {% endif %}
        </form>

        <hr>

        <h3 >Agregar canciones</h3>
        <p style="font-size: smaller;">Asegurate de saber lo que haces.</p>
        <p style="font-size: smaller;">El siguiente enlace tiene instrucciones para agregar una cancion.</p>
        <a style="font-size: smaller;" href="https://github.com/Heredento/campanario-chaleco/blob/main/campanario/media/songs/utilities/templatesong.py">Documentación de github</a>
        <a href="" style="font-size: smaller;">Documentación interna</a>
        <form action="{% url 'uploadFile' %}" method="post" enctype="multipart/form-data">
            {% csrf_token %} 
            <input type="file" enctype="multipart/form-data" name="file" title="sheesh" placeholder="Hola"  id="songfile" accept=".py" > 
            <button type="submit">Subir Archivo</button>
        </form>
        {% if fileIsValid is True %}
        {% elif fileIsValid is False %}
            <p>Ha sucedido un problema</p>
            <p>El documento que ingresaste no cumple alguno de los requisitos.</p>
        {% endif %}
        {% if successfulUpload is True %}
            <p>Canción {{songname}} agregada exitosamente</p>
        {% elif successfulUpload is False %}

        {% endif%}

        <hr>
        <h3>Canciones listadas</h3>
        <p style="font-size: smaller;">Canciones registradas para ser reproducidas en el campanario</p>
        <div class="listeventos">
            <form action="{% url 'deleteSong' %}" method="post">
                {% csrf_token %}
                {% for event in events  %}
                <div class="flex flexrow">
                    <div class="flex">
                        <p id="songname">{{ event.title }}</p>
                    </div>
                    <div class="flex">
                        <button type="submit" for="songname" name="{{ event.id }}">
                            <img src="{% static 'eventos/img/trash-white.png' %}" class="trashicon">
                        </button>
                    </div>
                </div>

                
                {% endfor %}    
            </form>
        </div>
        <h3>Recuperación de canciones listadas</h3>
        <p style="font-size: smaller;">Canciones listadas recuperables</p>
        <div class="listeventos">
            <form action="{% url 'recoverSong' %}" method="post">
                {% csrf_token %}
                {% for backup in backups  %}
                <div class="flex flexrow">
                    <div class="flex">
                        <p id="songname">{{ backup.title }}</p>
                    </div>
                    <div class="flex">
                        <p id="songname">Creado el</p>
                        <p>{{ backup.creationdate }}</p>
                    </div>
                    <div class="flex">
                        <button type="submit" for="songname" name="{{ backup.id }}">
                            <img src="{% static 'eventos/img/recover_icon.png' %}" class="trashicon">
                        </button>
                    </div>
                </div>

                
                {% endfor %}    
            </form>

        </div>


    </div> 





</body>

</body>
{% endblock %}

